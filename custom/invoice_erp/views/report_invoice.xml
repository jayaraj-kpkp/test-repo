<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_invoice_document_custom" inherit_id="account.report_invoice_document">

        <!-- Change invoice title -->
        <xpath expr="//h2[contains(@class, 'text-center')]" position="replace">
            <h2 class="text-center">
                <strong>Tax Invoice (Saudi Arabia)</strong>
            </h2>
        </xpath>

        <!-- Company Names: English & Arabic -->
        <xpath expr="//div[@class='company']" position="before">
            <div class="text-center" style="color:#800000; font-size:16px; font-weight:bold; text-decoration: underline;">
                <div t-field="company.name"/><br/>
                <div>اسم الشركة</div>
            </div>
        </xpath>

        <!-- Increase logo size -->
        <xpath expr="//div[@class='header']" position="inside">
            <t t-if="company.logo">
                <img t-att-src="'data:image/png;base64,%s' % company.logo"
                     style="max-height:120px; max-width:250px;" class="mx-auto d-block"/>
            </t>
        </xpath>

        <!-- Add Arabic next to P.O, Terms, Delivery No -->
        <xpath expr="//th[contains(text(),'P.O')] | //th[contains(text(),'Terms')] | //th[contains(text(),'Delivery Note')]" position="replace">
            <th>P.O No / رقم أمر الشراء</th>
            <th>Terms / الشروط</th>
            <th>Delivery Note No / رقم مذكرة التسليم</th>
        </xpath>

        <!-- Custom QR Code section (below totals) -->
        <xpath expr="//div[@class='row mt-3 mb-0']/following-sibling::div[1]" position="before">
            <div class="row mt-3">
                <div class="col-6">
                    <strong>QR Code (ZATCA):</strong><br/>
                    <img t-if="o.qr_code_image"
                         t-att-src="'data:image/png;base64,%s' % o.qr_code_image"
                         style="width:120px; height:120px;"/>
                </div>
            </div>
        </xpath>

        <!-- Optional: Show product description in "Description" column -->
        <xpath expr="//td[@name='name']" position="replace">
            <td name="name">
                <div t-if="line.name">
                    <span t-esc="line.name"/>
                </div>
            </td>
        </xpath>

        <!-- Show PCS or MTR in UOM column -->
        <xpath expr="//td[@name='product_uom_id']" position="replace">
            <td name="product_uom_id">
                <span t-if="line.product_uom_id.name == 'PCS'">PCS</span>
                <span t-if="line.product_uom_id.name == 'MTR'">MTR</span>
                <span t-if="line.product_uom_id.name not in ['PCS', 'MTR']">
                    <span t-esc="line.product_uom_id.name"/>
                </span>
            </td>
        </xpath>

        <!-- Hardcode VAT to 15% (if needed) -->
        <xpath expr="//td[@name='tax_ids']" position="replace">
            <td name="tax_ids">
                15%
            </td>
        </xpath>

    </template>
</odoo>
