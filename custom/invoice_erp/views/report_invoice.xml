<?xml version="1.0" encoding="utf-8"?>
<odoo>

  <!-- ✅ Overriding only the template, not the report action -->
  <template id="report_invoice_document" inherit_id="account.report_invoice_document">
    <t t-call="web.external_layout">
      <t t-foreach="docs" t-as="o">
        <main>
          <div class="page">

            <!-- ✅ Your existing invoice layout STARTS HERE -->

            <!-- HEADER -->
            <table width="100%" style="font-size:12px; border-collapse:collapse;">
              <tr>
                <td style="width:45%;">
                  <img t-if="o.company_id.logo" t-att-src="'data:image/png;base64,%s' % to_text(o.company_id.logo)" style="max-height:120px; max-width:220px;"/>
                </td>
                <td style="width:55%; text-align:right;">
                  <h2 style="margin-bottom:0px; color:#800000; font-size:18px; text-decoration: underline;"><strong><span t-esc="o.company_id.name"/></strong></h2>
                  <h2 style="margin-top:0px; color:#800000; font-size:16px; text-decoration: underline;"><strong><span t-esc="o.company_id.name_arabic or ''"/></strong></h2>
                </td>
              </tr>
            </table>

            <!-- TITLE -->
            <h2 class="text-center" style="margin:12px 0;">Tax Invoice<br/>فاتورة ضريبية</h2>

            <!-- CUSTOMER INFO TABLE -->
            <table width="100%" style="font-size:11px; border-collapse:collapse; margin-top:6px;">
              <tr>
                <td><strong>Invoice No:</strong> <span t-esc="o.name or ''"/></td>
                <td><strong>Customer:</strong> <span t-esc="o.partner_id.name or ''"/></td>
                <td><strong>Date:</strong> <span t-esc="format_date(o.invoice_date)"/></td>
              </tr>
              <tr>
                <td><strong>رقم الفاتورة</strong></td>
                <td><strong>العميل</strong></td>
                <td><strong>التاريخ</strong></td>
              </tr>
            </table>

            <!-- OPTIONAL FIELDS -->
            <table width="100%" style="font-size:11px; border-collapse:collapse; margin-top:6px;">
              <tr>
                <td><strong>P.O No:</strong> <span t-esc="o.ref or ''"/></td>
                <td><strong>Terms:</strong> <span t-esc="o.invoice_payment_term_id.name or ''"/></td>
                <td><strong>Delivery Note No:</strong> <span t-esc="o.invoice_origin or ''"/></td>
              </tr>
              <tr>
                <td><strong>رقم أمر الشراء</strong></td>
                <td><strong>شروط</strong></td>
                <td><strong>رقم إشعار التسليم</strong></td>
              </tr>
            </table>

            <!-- INVOICE TABLE -->
            <table width="100%" style="font-size:11px; border-collapse:collapse; margin-top:6px;">
              <thead>
                <tr style="background-color:#f0f0f0;">
                  <th style="border:1px solid #000; padding:4px;">S.N<br/>مسلسل</th>
                  <th style="border:1px solid #000; padding:4px;">Description<br/>الوصف</th>
                  <th style="border:1px solid #000; padding:4px;">Qty<br/>الكمية</th>
                  <th style="border:1px solid #000; padding:4px;">Unit<br/>الوحدة</th>
                  <th style="border:1px solid #000; padding:4px;">Unit Price<br/>سعر الوحدة</th>
                  <th style="border:1px solid #000; padding:4px;">Amount<br/>المبلغ</th>
                  <th style="border:1px solid #000; padding:4px;">VAT 15%<br/>ضريبة القيمة المضافة</th>
                  <th style="border:1px solid #000; padding:4px;">Total<br/>الإجمالي</th>
                </tr>
              </thead>
              <tbody>
                <tr t-foreach="o.invoice_line_ids" t-as="line" t-if="line.display_type == False">
                  <td style="border:1px solid #000; padding:4px;"><span t-esc="line.sequence or ''"/></td>
                  <td style="border:1px solid #000; padding:4px;"><span t-esc="line.name or ''"/></td>
                  <td style="border:1px solid #000; padding:4px;"><span t-esc="line.quantity"/></td>
                  <td style="border:1px solid #000; padding:4px;">
                    <t t-if="line.product_uom_id.name == 'Meter'">MTR</t>
                    <t t-else="">PCS</t>
                  </td>
                  <td style="border:1px solid #000; padding:4px;"><span t-esc="format_amount(line.price_unit, o.currency_id)"/></td>
                  <td style="border:1px solid #000; padding:4px;"><span t-esc="format_amount(line.price_subtotal, o.currency_id)"/></td>
                  <td style="border:1px solid #000; padding:4px;"><span t-esc="format_amount(line.price_total - line.price_subtotal, o.currency_id)"/></td>
                  <td style="border:1px solid #000; padding:4px;"><span t-esc="format_amount(line.price_total, o.currency_id)"/></td>
                </tr>
              </tbody>
            </table>

            <!-- TOTALS -->
            <table width="100%" style="font-size:11px; border-collapse:collapse; margin-top:6px;">
              <tr>
                <td style="text-align:right;"><strong>Subtotal:</strong> <span t-esc="format_amount(o.amount_untaxed, o.currency_id)"/></td>
              </tr>
              <tr>
                <td style="text-align:right;"><strong>VAT 15%:</strong> <span t-esc="format_amount(o.amount_tax, o.currency_id)"/></td>
              </tr>
              <tr>
                <td style="text-align:right;"><strong>Total:</strong> <span t-esc="format_amount(o.amount_total, o.currency_id)"/></td>
              </tr>
            </table>

            <!-- ✅ Your existing invoice layout ENDS HERE -->

          </div>
        </main>
      </t>
    </t>
  </template>

</odoo>
