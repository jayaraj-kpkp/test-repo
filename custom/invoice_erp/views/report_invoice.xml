<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <template id="report_invoice_document_custom">
    <t t-call="web.external_layout">
      <t t-foreach="docs" t-as="o">
        <main>
          <div class="page">

            <!-- HEADER -->
            <div class="header-container" style="width:100%; font-size:12px;">
              <table width="100%" style="border-bottom:1px solid #000; padding-bottom:5px; table-layout:fixed;">
                <tr>
                  <td style="width:50%; text-align:left; vertical-align:top; word-wrap:break-word;">
                    <strong>SAMEER SHARAF AL OTAIBI TRADING COMPANY</strong><br/>
                    C.R.: 4030216154<br/>
                    VAT Reg.: 311299944700003<br/>
                    Al Anwar Centre, Showroom No.12, Baladiya Street<br/>
                    Jeddah 23334, Saudi Arabia<br/>
                    Tel: 0536122833<br/>
                    Email: ssaoe.jeddah@gmail.com
                  </td>
                  <td style="width:50%; text-align:right; vertical-align:top; word-wrap:break-word;">
                    <strong>شركة سمير شرف العتيبي التجارية</strong><br/>
                    السجل التجاري: 4030216154<br/>
                    ضريبة القيمة المضافة: 311299944700003<br/>
                    مركز الأنوار، معرض رقم 12، شارع البلدية<br/>
                    جدة 23334، المملكة العربية السعودية<br/>
                    هاتف: 0536122833<br/>
                    البريد الإلكتروني: ssaoe.jeddah@gmail.com
                  </td>
                </tr>
              </table>

              <div style="text-align:center; margin:8px 0;">
                <img t-att-src="'/invoice_erp/static/src/img/faakart_logo.png'" style="max-height:80px;"/>
              </div>

              <div style="background-color:#b30000; color:#fff; text-align:center; font-size:16px; font-weight:bold; padding:4px; border-radius:4px; margin-top:5px;">
                Tax Invoice / فاتورة ضريبية
              </div>
            </div>

            <!-- CUSTOMER + INVOICE INFO -->
            <div style="margin-top:5px;">
              <table width="100%" style="font-size:12px; border:1px solid #000;">
                <tr>
                  <td><strong>Sold To / العميل:</strong><br/><span t-field="o.partner_id.name"/></td>
                  <td><strong>VAT No:</strong><br/><span t-field="o.partner_id.vat"/></td>
                  <td><strong>Invoice No:</strong><br/><span t-field="o.name"/></td>
                  <td><strong>Invoice Date:</strong><br/><span t-field="o.invoice_date"/></td>
                </tr>
              </table>
            </div>

            <!-- LINES TABLE -->
            <table class="invoice-table" width="100%" style="margin-top:8px; border-collapse:collapse;">
              <thead>
                <tr>
                  <th>S.N</th>
                  <th>Description / الوصف</th>
                  <th>Operation</th>
                  <th>UoM</th>
                  <th>Qty</th>
                  <th>Unit Price</th>
                  <th>Discount %</th>
                  <th>VAT %</th>
                  <th>VAT Amt</th>
                  <th>Line Total</th>
                </tr>
              </thead>
              <tbody>
                <t t-foreach="enumerate(o.invoice_line_ids)" t-as="line_with_index">
                  <tr>
                    <td><span t-esc="line_with_index[0] + 1"/></td>
                    <td><span t-esc="line_with_index[1].name"/></td>
                    <td><span t-esc="line_with_index[1].product_id.default_code or ''"/></td>
                    <td><span t-esc="line_with_index[1].product_uom_id.name"/></td>
                    <td><span t-esc="line_with_index[1].quantity"/></td>
                    <td><span t-esc="line_with_index[1].price_unit"/></td>
                    <td><span t-esc="line_with_index[1].discount"/></td>
                    <td>
                      <t t-foreach="enumerate(line_with_index[1].tax_ids)" t-as="tax_with_index">
                        <span t-esc="tax_with_index[1].amount"/>%
                        <t t-if="tax_with_index[0] + 1 != len(line_with_index[1].tax_ids)">, </t>
                      </t>
                    </td>
                    <td><span t-esc="line_with_index[1].price_total - line_with_index[1].price_subtotal"/></td>
                    <td><span t-esc="line_with_index[1].price_total"/></td>
                  </tr>
                </t>
              </tbody>
            </table>

            <!-- TOTALS + Amount in Words -->
            <div style="margin-top:10px;">
              <table width="100%" style="font-size:12px;">
                <tr>
                  <td>
                    <p><strong>Amount in Words:</strong><br/>
                    <span t-esc="o.currency_id.amount_to_text(o.amount_total)"/>
                    </p>
                  </td>
                  <td>
                    <table style="border:1px solid #000; width:300px;">
                      <tr><td>Net Amount</td><td><span t-esc="o.amount_untaxed"/></td></tr>
                      <tr><td>VAT Amount</td><td><span t-esc="o.amount_tax"/></td></tr>
                      <tr><td><strong>Grand Total</strong></td><td><strong><span t-esc="o.amount_total"/></strong></td></tr>
                    </table>
                  </td>
                </tr>
              </table>
            </div>
          </div>
        </main>
      </t>
    </t>
  </template>
</odoo>
